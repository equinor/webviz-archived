<form id="form_{{element.containerId}}">
    {% for key in element.check_box_filters %}
    <fieldset id="{{key}}_fieldset_{{element.containerId}}"
              style='display:inline-block'>
        <legend> {{key}} </legend>
        <div style='height:100px; overflow-y: auto'>
        {% for label in element.labels[key] %}
            <div>
                <input id='{{key}}{{label}}box{{element.containerId}}'
                       type="checkbox"
                       name="{{key}}-{{label}}"
                       value={{label}}/ checked>
                    <label for="{{key}}">{{label}}</label>
            </div>
        {% endfor %}
    </fieldset>
    {% endfor %}
</form>
<div id="{{element.containerId}}" style="height: 600px">
</div>

<script>
    (function () {

        let labels = {{element.get_json_dump("labels")}}
        let boxes = {}
        Object.keys(labels).forEach(key =>
            labels[key].forEach(label => {
                if(!boxes[key]) boxes[key] = {}
                boxes[key][label] = document.querySelector(
                    '#' + key + label + 'box{{element.containerId}}'
                )
                }
            )
        )
        plotly_checkbox_filter(
            "{{element.containerId}}",
            boxes,
            {{element.get_json_dump("data")}},
            {{element.get_json_dump("layout")}},
            {{element.get_json_dump("config")}}
        )
    }())
</script>
